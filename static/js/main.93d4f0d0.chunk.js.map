{"version":3,"sources":["components/VideoViewer/VideoControls.js","util/HlsUtils.js","components/VideoViewer/VideoPlayer.js","util/Mp4Info.js","components/SourceSelector/index.js","components/SplitView/index.js","util/formatTime.js","components/VideoViewer/TimeDisplay.js","components/VideoViewer/OffsetIndicator.js","keymap.js","components/Help/index.js","components/VideoViewer/index.js","util/FullscreenUtils.js","App.js","serviceWorker.js","index.js"],"names":["VideoControls","_ref","onPlay","onStep","onFullscreen","playing","onSeek","position","duration","react_default","a","createElement","className","onClick","event","stopPropagation","fi","cx","console","log","type","value","min","max","step","onInput","e","concat","target","nextPos","parseFloat","isHlsPlaylist","url","split","endsWith","parseHlsManifest","_x","_parseHlsManifest","apply","this","arguments","_callee","response","manifestText","parser","manifest","variants","regenerator_default","wrap","_context","prev","next","fetch","sent","text","Parser","push","end","playlists","map","playlist","Object","objectSpread","resolveVariantUrl","uri","bandwidth","attributes","BANDWIDTH","RESOLUTION","abrupt","mainUrl","selectedVariant","stop","variantUrl","indexOf","replace","VideoPlayer","props","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","zoom","panHorizontal","panVertical","setVideoRef","videoRef","videoElement","onTimeUpdate","addEventListener","currentTime","onDurationSet","play","pause","pos","zoomFactor","newPanHorizontal","document","documentElement","clientWidth","newPanVertical","clientHeight","setState","deltaX","deltaY","offsetHeight","Promise","reject","resolve","_this2","once","_this3","loadHls","src","hls","Hls","loadSource","attachMedia","width","parseInt","muted","ref","tabIndex","style","left","top","Component","fetchUntilDone","onData","isDone","chunkSize","start","responseData","data","totalSize","_args","length","undefined","fetchRange","contentRange","fileStart","Math","_callee2","range","_context2","method","headers","Range","ok","Error","status","arrayBuffer","t0","t1","get","t2","contentLength","_callee3","done","mp4boxfile","mp4InfoPromise","_context3","MP4Box","onError","onReady","info","appendBuffer","catch","trace","mp4Info","SourceSelector","bind","assertThisInitialized","urlInputKeyDown","source","defaultSource","showUrlInput","inputRef","input","hlsMetadata","then","changeSource","removeEventListener","keyCode","onUrlSelected","hideUrlInput","evt","files","onChange","name","file","window","URL","createObjectURL","setVariant","assign","prevSource","loadHlsMetadata","variant","revokeObjectURL","loadMp4Metadata","prevProps","prevState","snapshot","focus","bitrate","height","round","_this4","metadataSpan","options","i","key","formatMetadata","onVariantSelected","videoTrack","videoTracks","video","title","_this5","cursor","onFileSelected","hidden","setInputRef","onBlur","defaultValue","currentUrl","renderSelectedSource","SplitView","mouseMove","mouseDown","mouseUp","splitPercent","dragStart","dragging","setSplitViewContainerRef","splitViewContainer","setSplitViewClipperRef","splitViewClipper","passive","ignoreNextClick","x","clientX","y","clientY","nextProps","nextState","tracking","setSplitPosition","onDrag","movementX","movementY","trackLocation","rect","getBoundingClientRect","pageX","offsetWidth","show-border","splitBorderVisible","leftSideContent","children","zeroPad","num","formatTime","hours","floor","minutes","seconds","frames","TimeDisplay","OffsetIndicator","offset","sign","command","keys","description","COMMANDS","PLAY","PAUSE","PLAY_PAUSE","STEP_FORWARD_FRAME","STEP_BACKWARD_FRAME","STEP_FORWARD","STEP_BACKWARD","FULLSCREEN","TOGGLE_TRACKING","LEFT_ONLY","RIGHT_ONLY","TIMESHIFT_DECREASE","TIMESHIFT_INCREASE","TIMESHIFT_RESET","ZOOM_IN","ZOOM_OUT","PAN_UP","PAN_DOWN","PAN_RIGHT","PAN_LEFT","REST_PAN_ZOOM","TOGGLE_HELP","TOGGLE_SPLIT_BORDER_VISIBLE","KEY_MAP","reduce","result","defineProperty","JSON","stringify","Help","visible","generateKeymapHelp","HelpButton","_ref2","urlParams","URLSearchParams","location","search","leftVideoUrl","rightVideoUrl","leftVideoVariant","rightVideoVariant","startPosition","Number","DEFAULT_SOURCE_LEFT","DEFAULT_SOURCE_RIGHT","VideoViewer","shortCutHandlers","playPause","fullscreen","toggleTracking","splitView","changeOffset","zoomIn","zoomOut","pan","resetPanZoom","playForward","toggleShowHelp","toggleSplitBorderVisible","slicedToArray","action","setVideoViewerRef","videoViewer","setRightVideoRef","rightVideo","setLeftVideoRef","leftVideo","setSplitViewRef","leftSource","rightSource","rightVideoOffset","showHelp","playReverse","userDefinedPanZoom","onFullScreenChange","delta","seek","steps","newTime","quickSeek","elem","fullScreen","mozFullScreen","webkitIsFullScreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","time","setPosition","playbackRate","all","setPlaying","setLeftSource","setRightSource","wasPlaying","wasPlayingReverse","VideoViewer_TimeDisplay","index_es","keyMap","handlers","src_components_SplitView","dx","dy","VideoViewer_VideoPlayer","size","VideoViewer_VideoControls","n","src_components_SourceSelector","onLeftSourceChange","onRightSourceChange","VideoViewer_OffsetIndicator","Help_Help","Help_HelpButton","App","src_components_VideoViewer","Boolean","hostname","match","ReactDOM","render","src_App_0","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.93d4f0d0.chunk.js","sourcesContent":["import React from 'react';\nimport cx from 'classnames';\nimport {FiPlay, FiPause, FiSkipBack, FiSkipForward, FiMaximize} from 'react-icons/fi';\n\n\nconst VideoControls = ({onPlay, onStep, onFullscreen, playing, onSeek, position, duration}) => {\n\n    return (<div className=\"controls\">\n        <button className=\"btn btn-default\" onClick={(event) => {\n            onStep(-1);\n            event.stopPropagation();\n        }}><FiSkipBack /></button>\n        <button className={cx('btn', 'btn-default') }\n                onClick={(event) => {\n                    console.log('play/pause: ' );\n                    onPlay();\n                    event.stopPropagation();\n                }}>{playing ? (<FiPause/>) : (<FiPlay />)}</button>\n        <button className=\"btn btn-default\" onClick={(event) => {\n            onStep(1);\n            event.stopPropagation();\n        }}><FiSkipForward/></button>\n\n        <input type=\"range\" value={position} min=\"0\" max={duration} step=\"0.04\" onInput={(e) => {\n            console.log(`range value: ${e.target.value}`);\n            const nextPos = parseFloat(e.target.value);\n            onSeek(nextPos);\n            e.stopPropagation();\n        }} />\n\n        <button className=\"btn btn-default glyphicon glyphicon-fullscreen\" onClick={(event) => {\n            onFullscreen();\n            event.stopPropagation();\n        }}><FiMaximize/></button>\n    </div>)\n};\n\nexport default VideoControls;","import {Parser} from 'm3u8-parser';\n\nexport function isHlsPlaylist(url) {\n    return url.split('?')[0].endsWith('.m3u8');\n}\n\nexport async function parseHlsManifest(url) {\n    const response = await fetch(url);\n    const manifestText = await response.text();\n    const parser = new Parser();\n    parser.push(manifestText);\n    parser.end();\n    const manifest = parser.manifest;\n    const variants = manifest.playlists.map( playlist => {\n        return {\n            url: resolveVariantUrl(url, playlist.uri),\n            bandwidth: playlist.attributes.BANDWIDTH,\n            ...playlist.attributes.RESOLUTION,\n        };\n    });\n    return {\n        mainUrl: url,\n        variants,\n        selectedVariant: 0\n    };\n}\n\nfunction resolveVariantUrl(mainUrl, variantUrl) {\n    if (isAbsoluteUrl(variantUrl)) {\n        return variantUrl;\n    }\n    return mainUrl.replace(/\\/[^/]*$/, '/' + variantUrl)\n}\n\nfunction isAbsoluteUrl(url) {\n    return (url.indexOf('http://') === 0 || url.indexOf('https://') === 0)\n}","import React, {Component} from 'react';\nimport Hls from 'hls.js'\nimport {isHlsPlaylist} from \"../../util/HlsUtils\";\n\nconst zoomInMultiplier = 1.1;\nconst zoomOutMultiplier = 1/zoomInMultiplier;\n\nclass VideoPlayer extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            zoom: 1,\n            panHorizontal: 0,\n            panVertical: 0\n        };\n        this.setVideoRef =  (videoRef) => {\n            this.videoElement = videoRef;\n            if(videoRef !== null) {\n                if (this.props.onTimeUpdate) {\n                    this.videoElement.addEventListener('timeupdate', () => {\n                        this.props.onTimeUpdate(this.videoElement.currentTime);\n                    });\n                }\n                if (this.props.onDurationSet) {\n                    this.videoElement.addEventListener('loadedmetadata', () => {\n                        this.props.onDurationSet(this.videoElement.duration);\n                    });\n                }\n            }\n        };\n    }\n\n    async play() {\n        return this.videoElement.play();\n    }\n\n    pause() {\n        this.videoElement.pause();\n    }\n\n    quickSeek(pos) {\n        this.videoElement.currentTime = pos;\n    }\n\n    zoomIn() {\n        this.zoom(zoomInMultiplier);\n    }\n\n    zoomOut() {\n        this.zoom(zoomOutMultiplier);\n    }\n\n    zoom(zoomFactor) {\n        const newPanHorizontal = (1 - zoomFactor ) / 2 * document.documentElement.clientWidth +\n            zoomFactor * this.state.panHorizontal;\n        const newPanVertical = (1 - zoomFactor) / 2 * document.documentElement.clientHeight +\n            zoomFactor * this.state.panVertical;\n        this.setState({\n            zoom: this.state.zoom * zoomFactor,\n            panHorizontal: newPanHorizontal,\n            panVertical: newPanVertical\n        });\n    }\n\n    pan(deltaX, deltaY) {\n        this.setState({\n            panHorizontal: this.state.panHorizontal + deltaX,\n            panVertical: this.state.panVertical + deltaY});\n    }\n\n    resetPanZoom() {\n        const clientHeight = document.documentElement.clientHeight;\n        const videoElementHeight = this.videoElement.offsetHeight / this.state.zoom;\n        const panVertical = (clientHeight - videoElementHeight) / 2;\n        this.setState({\n            zoom: 1,\n            panHorizontal: 0,\n            panVertical: panVertical\n        });\n    }\n\n    async seek(pos) {\n        if (pos > this.videoElement.duration) {\n            return Promise.reject(`Invalid seek position: ${pos}, media duration is ${this.videoElement.duration}`);\n        }\n        return new Promise((resolve, reject) => {\n            this.videoElement.addEventListener('seeked', () => {\n                resolve();\n            }, { once: true});\n            this.videoElement.currentTime = pos;\n        })\n    }\n\n\n    async loadSource(url) {\n        console.log(`load source: ${url}`);\n        return new Promise((resolve, reject) => {\n            this.videoElement.addEventListener('canplay',\n                () => {\n                    resolve();\n                },\n                { once: true });\n            if (isHlsPlaylist(url)) {\n                this.loadHls(url)\n            } else {\n                this.videoElement.src = url;\n            }\n        });\n    }\n\n    loadHls(url) {\n        let hls = this.state.hls;\n        if (!hls) {\n            hls = new Hls();\n            this.setState({hls});\n        }\n        hls.loadSource(url);\n        hls.attachMedia(this.videoElement);\n\n    }\n\n    currentTime() {\n        return this.videoElement.currentTime;\n    }\n\n    render() {\n        const width = parseInt(100 * this.state.zoom) + 'vw';\n        return (\n            <video muted={this.props.muted} ref={this.setVideoRef}\n                   tabIndex=\"-1\"\n                   style={{\n                       width: width,\n                       left: this.state.panHorizontal + 'px',\n                       top: this.state.panVertical + 'px'\n                   }}\n            >\n            </video>\n        )\n    }\n}\n\nexport default VideoPlayer;","import MP4Box from 'mp4box';\n\nasync function fetchUntilDone(url, onData,isDone, chunkSize = 10 * 1024 * 1024) {\n    let start = 0;\n    let end = chunkSize;\n    while(!isDone()) {\n        const responseData = await fetchRange(url, {start, end});\n        const data = responseData.data;\n        const totalSize = parseInt(responseData.contentRange.split('/')[1]);\n        data.fileStart = start;\n        onData(data);\n        if (end === totalSize) break;\n        start = end;\n        end = Math.min(totalSize, start + chunkSize);\n        if (data.length  < chunkSize) break;\n    }\n}\n\nasync function fetchRange(url, range) {\n    const response = await fetch(url, {\n        method: \"GET\",\n        headers: {\n            'Range': `bytes=${range.start}-${range.end}`\n        }\n    });\n    if (!response.ok) {\n        throw Error(`Fetch failed with status: ${response.status}`);\n    }\n    return {\n        data: await response.arrayBuffer(),\n        contentLength: response.headers.get('Content-Length'),\n        contentRange:  response.headers.get('Content-Range')\n    }\n}\n\nasync function mp4Info(url) {\n    console.log(`mp4Info: ${url}`);\n    let done = false;\n    const mp4boxfile = new MP4Box.MP4Box();\n\n    const mp4InfoPromise = new Promise((resolve, reject) => {\n        mp4boxfile.onError = e => {\n            done = true;\n            console.log(e);\n            reject(e);\n        };\n\n        mp4boxfile.onReady = (info) => {\n            done = true;\n            resolve(info);\n        };\n    });\n\n    fetchUntilDone(url,\n        (data) => {\n            mp4boxfile.appendBuffer(data)\n        },\n        () => done)\n        .catch(e => {\n            console.log(`error: ${e}`);\n            console.trace(e);\n        });\n\n    return mp4InfoPromise\n}\n\nexport default mp4Info;","import React, {Component} from 'react';\nimport {FiFile, FiGlobe} from \"react-icons/fi\";\nimport cx from 'classnames';\nimport './index.css';\nimport {isHlsPlaylist, parseHlsManifest} from '../../util/HlsUtils';\nimport mp4Info from '../../util/Mp4Info';\n\nclass SourceSelector extends Component {\n\n    constructor(props) {\n        super(props);\n        this.stopPropagation = this.stopPropagation.bind(this);\n        this.urlInputKeyDown = this.urlInputKeyDown.bind(this);\n        this.state = {\n            source: this.props.defaultSource,\n            showUrlInput: false\n        };\n    }\n\n    setInputRef(inputRef) {\n        this.input = inputRef;\n    }\n\n    async loadHlsMetadata(url) {\n        const hlsMetadata = await parseHlsManifest(url);\n        this.setState({hls: hlsMetadata});\n    }\n\n    loadMp4Metadata(url) {\n        mp4Info(url)\n            .then((mp4Info) => {\n                this.setState({mp4Info})\n            })\n            .catch(e => console.trace(e));\n    }\n\n    componentDidMount() {\n        this.changeSource(this.state.source);\n        console.log('Source selector add event listeners');\n        this.input.addEventListener('keydown', this.urlInputKeyDown);\n        this.input.addEventListener('keypress', this.stopPropagation);\n        this.input.addEventListener('keyup', this.stopPropagation);\n    }\n\n    componentWillUnmount() {\n        this.input.removeEventListener('keydown', this.urlInputKeyDown);\n        this.input.removeEventListener('keypress', this.stopPropagation);\n        this.input.removeEventListener('keyup', this.stopPropagation);\n    }\n\n    stopPropagation(e) {\n        e.stopPropagation();\n    }\n\n    urlInputKeyDown(e) {\n        e.stopPropagation();\n        switch (e.keyCode) {\n            case 13:\n                this.onUrlSelected(e.target.value);\n                break;\n            case 27:\n                this.hideUrlInput();\n                break;\n            default:\n        }\n    }\n\n    onBlur() {\n        console.log('onBlur');\n        this.setState({showUrlInput: false})\n    }\n\n    handleChange(evt) {\n        if (evt.target.files) {\n            this.props.onChange(evt.target.files[0])\n        }\n    }\n\n    showUrlInput() {\n        this.setState({showUrlInput: true});\n    }\n\n    hideUrlInput() {\n        this.setState({showUrlInput: false});\n    }\n\n    onUrlSelected(url) {\n        console.log(`url: ${url}`);\n        this.hideUrlInput();\n        this.changeSource({\n            type: 'url',\n            name: url,\n            url: url\n        })\n    }\n\n    onFileSelected(evt) {\n        if (evt.target.files && evt.target.files[0]) {\n            const file = evt.target.files[0];\n            this.changeSource({\n                type: 'file',\n                name: file.name,\n                url: window.URL.createObjectURL(file),\n            });\n        }\n    }\n\n    onVariantSelected(evt) {\n        console.log(`variant selected: ${evt.target.value}`);\n        const selectedVariant = evt.target.value;\n        this.setVariant(selectedVariant);\n    }\n\n    setVariant(selectedVariant) {\n        this.setState({hls: Object.assign({}, this.state.hls, {selectedVariant})});\n        const url = this.state.hls.variants[selectedVariant].url;\n        this.props.onChange(Object.assign({}, this.state.source, {url}));\n    }\n\n    changeSource(source) {\n        const prevSource = this.state.source;\n        if (isHlsPlaylist(source.url)) {\n            this.setState({source, mp4Info: null});\n            this.loadHlsMetadata(source.url)\n                .then(() => {\n                    this.setVariant(source.variant ? source.variant : 0);\n                    if (prevSource.type === 'file' && prevSource.url) {\n                        window.URL.revokeObjectURL(prevSource);\n                    }\n                });\n        } else {\n            this.setState({source, hls: null});\n            this.loadMp4Metadata(source.url);\n            this.props.onChange(source);\n            if (prevSource.type === 'file' && prevSource.url) {\n                window.URL.revokeObjectURL(prevSource);\n            }\n        }\n    }\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (this.state.showUrlInput) {\n            this.input.focus()\n        }\n    }\n\n    currentUrl() {\n        return this.state.source.type === 'url' ? this.state.source.url : '';\n    }\n\n    formatMetadata(bitrate, width, height) {\n        return `[${Math.round(bitrate / 1000)}kbit/s ${width}x${height}]`\n    }\n\n    renderSelectedSource() {\n        if (this.state.showUrlInput) {\n            return null;\n        }\n        let metadataSpan = null;\n        if (this.state.hls) {\n            const options = this.state.hls.variants.map( (variant, i) => {\n               return (<option\n                   key={i}\n                   value={i}\n               >\n                   {this.formatMetadata(variant.bandwidth,variant.width, variant.height)}\n               </option>);\n            });\n            metadataSpan = (<select value={this.state.hls.selectedVariant} onChange={(e) => this.onVariantSelected(e)}>{options}</select>);\n        } else if (this.state.mp4Info) {\n            const videoTrack = this.state.mp4Info.videoTracks[0];\n            const bitrate = videoTrack.bitrate;\n            const width = videoTrack.video.width;\n            const height = videoTrack.video.height;\n            metadataSpan = (<span>{this.formatMetadata(bitrate, width, height)}</span>);\n        }\n        return (<div className=\"source-metadata\">\n            <div className=\"source-name\" title={this.state.source.name}>{this.state.source.name}</div>\n            <div>{metadataSpan}</div>\n        </div>);\n    }\n\n    render() {\n        return (\n            <div className={\"source-selector \" + this.props.className}>\n                <div className=\"source-buttons\">\n                    <div title=\"open URL\" className=\"url-button\" >\n                        <FiGlobe style={{cursor: 'pointer'}} onClick={() => this.showUrlInput()}/>\n                    </div>\n                    <label title=\"open local file\" className=\"source-file-input\" onClick={(evt) => {\n                        this.hideUrlInput();\n                        evt.stopPropagation()\n                    }}>\n                        <FiFile/>\n                        <input type=\"file\" onChange={(evt) => this.onFileSelected(evt) }/>\n                    </label>\n                </div>\n\n                <input className={cx('url-input',\n                    {hidden: !this.state.showUrlInput})}\n                       type=\"text\"\n                       ref={(ref) => this.setInputRef(ref)}\n                       onBlur={() => this.onBlur()}\n                       defaultValue={this.currentUrl()}\n                />\n\n                {this.renderSelectedSource()}\n\n            </div>\n        )\n    }\n}\n\nexport default SourceSelector;","import  React, {Component} from 'react';\nimport cx from 'classnames';\nimport './index.css';\n\n\nclass SplitView extends Component {\n    constructor(props) {\n        super(props);\n        this.mouseMove = this.mouseMove.bind(this);\n        this.mouseDown = this.mouseDown.bind(this);\n        this.mouseUp = this.mouseUp.bind(this);\n        console.log('Split view constructor');\n\n        this.state = {\n            splitPercent: 0,\n            dragStart: null,\n            dragging: false\n        };\n\n        this.setSplitViewContainerRef = splitViewContainer => {\n            this.splitViewContainer = splitViewContainer;\n\n        };\n\n        this.setSplitViewClipperRef = splitViewClipper => {\n            this.splitViewClipper = splitViewClipper;\n        };\n    }\n\n    componentDidMount() {\n        this.splitViewContainer.addEventListener(\"mousemove\", this.mouseMove, {passive: true});\n        this.splitViewContainer.addEventListener(\"mousedown\", this.mouseDown);\n        document.addEventListener(\"mouseup\", this.mouseUp);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener(\"mouseup\", this.mouseUp);\n        this.splitViewContainer.removeEventListener(\"mousedown\", this.mouseDown);\n        this.splitViewContainer.removeEventListener(\"mousemove\", this.mouseMove, {passive: true});\n    }\n\n    mouseUp(e) {\n        if (this.state.dragging) {\n            this.ignoreNextClick = true;\n        }\n        this.setState({dragStart: null, dragging: false});\n    }\n\n    onClick(e) {\n        if (this.ignoreNextClick) {\n            this.ignoreNextClick = false;\n        } else {\n            this.props.onClick(e);\n        }\n    }\n\n    mouseDown(e) {\n        this.setState({dragStart: {x: e.clientX, y: e.clientY}});\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        return true;\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if (this.props.tracking && !prevProps.tracking) {\n            this.setSplitPosition(this.state.splitPercent);\n        }\n    }\n\n    mouseMove(e) {\n        if (this.state.dragStart) {\n            this.setState({dragging: true});\n            this.props.onDrag(e.movementX, e.movementY);\n        } else {\n            this.trackLocation(e);\n        }\n    }\n\n    trackLocation(e) {\n        if (!this.splitViewContainer) {\n            return;\n        }\n        const rect = this.splitViewContainer.getBoundingClientRect();\n        const position = ((e.pageX - rect.left) / this.splitViewContainer.offsetWidth)*100;\n        if (position <= 100) {\n            this.setState({splitPercent: position});\n            if (this.props.tracking) {\n                this.setSplitPosition(position);\n            }\n        }\n    }\n\n    setSplitPosition(position) {\n        this.splitViewClipper.style.width = position+\"%\";\n    }\n\n    focus() {\n        this.splitViewContainer.focus();\n    }\n\n    render() {\n        return (\n            <div className={cx('split-view-container', {'dragging': this.state.dragging})} ref={(ref) => this.setSplitViewContainerRef(ref)}\n            tabIndex=\"-1\"\n            onClick={(e) => this.onClick(e) }>\n                <div className={cx(\"split-view-clipper\", {\"show-border\": this.props.splitBorderVisible})} ref={(ref) => this.setSplitViewClipperRef(ref)}>\n                    {this.props.leftSideContent}\n                </div>\n                {this.props.children}\n            </div>\n        )\n    }\n}\n\nexport default SplitView;\n","function formatTime(position) {\n    const hours = Math.floor(position / 3600);\n    const minutes = Math.floor((position % 3600) / 60);\n    const seconds = Math.floor(position % 60);\n    const frames = Math.floor((position - Math.floor(position)) / 0.04);\n    return zeroPad(hours) + ':' + zeroPad(minutes) + ':'\n        + zeroPad(seconds) + '.' + zeroPad(frames);\n}\n\nfunction zeroPad(num) {\n    return num < 10 ? '0' + num : '' + num;\n}\n\nexport default formatTime;","import React from 'react';\nimport formatTime from '../../util/formatTime';\n\nconst TimeDisplay = ({position}) => (<div className=\"time-display\">{formatTime(position)}</div>);\n\nexport default TimeDisplay;","import React from 'react';\n\nfunction sign(offset) {\n    return offset > 0 ? '+' : '';\n}\n\nconst OffsetIndicator = ({offset}) => {\n    if (offset === 0.0) {\n        return null;\n    }\n    return (<div className=\"offset-indicator\">offset: {sign(offset)}{offset * 0.04}</div>)\n};\n\nexport default OffsetIndicator;","\n\nconst command = (name, keys, description) => ({\n        name,\n        keys,\n        description\n});\n\nexport const COMMANDS = {\n\n        PLAY: command('PLAY', 'l', 'Play video'),\n        PAUSE: command('PAUSE', 'k', 'Pause video'),\n        PLAY_PAUSE: command('PLAY_PAUSE', 'space', 'Play/Pause video'),\n        STEP_FORWARD_FRAME: command('STEP_FORWARD_FRAME', '.', 'Step forward 1 frame'),\n        STEP_BACKWARD_FRAME: command('STEP_BACKWARD_FRAME', ',', 'Step backward 1 frame'),\n        STEP_FORWARD: command('STEP_FORWARD', ['/', '-'], 'Step forward 1 second'),\n        STEP_BACKWARD: command('STEP_BACKWARD', 'm', 'Step backward 1 second'),\n        FULLSCREEN: command('FULLSCREEN', 'f', 'Toggle full screen'),\n        TOGGLE_TRACKING: command('TOGGLE_TRACKING', 't', 'Toggle split position follows mouse'),\n        LEFT_ONLY: command('LEFT_ONLY', ']', 'View only left video'),\n        RIGHT_ONLY: command('RIGHT_ONLY', '[', 'View only right video'),\n        TIMESHIFT_DECREASE: command('OFFSET_DECREASE', '<', 'Decrease timeshift between videos'),\n        TIMESHIFT_INCREASE: command('OFFSET_INCREASE', '>', 'Increase timeshift between videos'),\n        TIMESHIFT_RESET: command('OFFSET_RESET', 'r', 'Reset timeshift between videos'),\n        ZOOM_IN: command('ZOOM_IN', 'u', 'Zoom in'),\n        ZOOM_OUT: command('ZOOM_OUT', 'i', 'Zoom out'),\n        PAN_UP: command('PAN_UP', 'up', 'Pan up'),\n        PAN_DOWN: command('PAN_DOWN', 'down', 'Pan down'),\n        PAN_RIGHT: command('PAN_RIGHT', 'right', 'Pan right'),\n        PAN_LEFT: command('PAN_LEFT', 'left', 'Pan left'),\n        REST_PAN_ZOOM: command('RESET_PAN_ZOOM', '0', 'Reset pan and zoom to default'),\n        TOGGLE_HELP: command('TOOGLE_HELP', 'esc', 'Toggle help window'),\n        TOGGLE_SPLIT_BORDER_VISIBLE: command('TOGGLE_SPLIT_BORDER_VISIBLE', 's', 'Toggle split border visible')\n};\n\n\nexport const KEY_MAP = Object.keys(COMMANDS).reduce((result, key) => Object.assign(result, {[COMMANDS[key].name]: COMMANDS[key].keys}), {});\n\nconsole.log(`KEY_MAP: ${JSON.stringify(KEY_MAP)}`);\n\n/*\nexport const KEY_MAP =\n    {\n        frameForward10: '/',\n        frameForward1: '.',\n        frameRewind1: ',',\n        frameRewind10: 'm',\n        playPause: 'space',\n        playForward: 'l',\n        pause: 'k',\n        playReverse: 'j',\n        fullscreen: 'f',\n        toggleTracking: 't',\n        leftOnly: ']',\n        rightOnly: '[',\n        offsetDecrease: '<',\n        offsetIncrease: '>',\n        zoomIn: 'u',\n        zoomOut: 'i',\n        panUp: 'up',\n        panDown: 'down',\n        panRight: 'right',\n        panLeft: 'left',\n        resetPanZoom: '0'\n\n    };\n\nexport default KEY_MAP;\n*/","import React from 'react';\nimport cx from 'classnames';\nimport {FiHelpCircle, FiX} from \"react-icons/fi\";\nimport './index.css';\nimport {COMMANDS} from '../../keymap';\n\n\nconst Help = ({visible, onClick}) => (\n    <div className={cx('help', {'hidden': !visible})}>\n        <div className='help-header'>\n            <h3>Vivict - Vivict Video Comparison Tool</h3>\n            <div className='close-button' onClick={() => onClick()}>\n                <FiX />\n            </div>\n        </div>\n        <div>\n            <h4>Keybindings:</h4>\n            {generateKeymapHelp()}\n        </div>\n    </div>);\n\nconst HelpButton = ({onClick, className}) => (\n    <div className={\"help-button \" + className}\n    onClick={(e) => onClick(e)}>\n        <FiHelpCircle/>\n    </div>\n);\n\nconst generateKeymapHelp = () => {\n    //return Array.from(KEY_MAP, ([key, value]) => (\n    return Object.keys(COMMANDS).map(key => {\n        const command = COMMANDS[key];\n        return (\n            <div key={\"keybinding-\" + command.name}><bold>{JSON.stringify(command.keys)}</bold>{\"  \" + command.description}</div>\n        )\n    });\n};\n\nexport {Help, HelpButton}","import React, {Component} from 'react';\nimport {HotKeys} from 'react-hotkeys';\nimport VideoControls from './VideoControls';\nimport VideoPlayer from './VideoPlayer';\nimport './index.css';\nimport SourceSelector from '../SourceSelector'\nimport SplitView from '../SplitView';\nimport TimeDisplay from './TimeDisplay';\nimport OffsetIndicator from './OffsetIndicator';\nimport {Help, HelpButton} from '../Help';\nimport {COMMANDS, KEY_MAP} from '../../keymap'\nimport {openFullscreen, isFullscreen, closeFullscreen} from \"../../util/FullscreenUtils\";\nimport {FiPlay} from 'react-icons/fi';\nimport cx from 'classnames';\n\nconst DEFAULT_SOURCE_URL = \"https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8\";\n\nconst urlParams = new URLSearchParams(window.location.search);\nconst leftVideoUrl = urlParams.get('leftVideoUrl') || DEFAULT_SOURCE_URL;\nconst rightVideoUrl = urlParams.get('rightVideoUrl') || leftVideoUrl;\nconst leftVideoVariant = urlParams.get('leftVideoVariant') || 0;\nconst rightVideoVariant = urlParams.get('rightVideoVariant') || 1;\nconst startPosition = Number(urlParams.get('position')) || 0;\n\n\nconst DEFAULT_SOURCE_LEFT = {\n    type: 'url',\n    name: leftVideoUrl,\n    url: leftVideoUrl,\n    variant: leftVideoVariant,\n    position: startPosition\n};\nconst DEFAULT_SOURCE_RIGHT = {\n    type: 'url',\n    name: rightVideoUrl,\n    url: rightVideoUrl,\n    variant: rightVideoVariant,\n    position: startPosition\n};\n\nclass VideoViewer extends Component {\n    constructor(props) {\n        super(props);\n        this.setVideoViewerRef = videoViewer => {\n            this.videoViewer = videoViewer;\n        };\n        this.setRightVideoRef = rightVideo => {\n            console.log('setRightVideoRef', rightVideo);\n            this.rightVideo = rightVideo;\n        };\n        this.setLeftVideoRef = leftVideo => {\n            this.leftVideo = leftVideo;\n        };\n        this.setSplitViewRef = splitView => {\n            this.splitView = splitView;\n        };\n        this.state = {\n            playing: false,\n            duration: 0,\n            position: 0,\n            leftSource: {name: \"NONE\", url: null},\n            rightSource:{name: \"NONE\", url: null},\n            tracking: true,\n            splitBorderVisible: true,\n            rightVideoOffset: 0,\n            showHelp: true,\n            playReverse: false,\n            userDefinedPanZoom: false\n        };\n\n        this.onFullScreenChange = this.onFullScreenChange.bind(this);\n    }\n\n    setPosition(position) {\n        this.setState({position});\n    }\n\n    setPlaying(playing) {\n        this.setState({playing})\n    }\n\n    setLeftSource(leftSource) {\n        this.setState({leftSource})\n    }\n\n    setRightSource(rightSource) {\n        this.setState({rightSource})\n    }\n\n    toggleTracking() {\n        this.setState({tracking: !this.state.tracking})\n    }\n\n    changeOffset(delta) {\n\n        if(delta === 0) {\n            this.setState({rightVideoOffset: delta});\n        } else {\n            this.setState({rightVideoOffset: this.state.rightVideoOffset + delta});\n        }\n\n        if (!this.state.playing) {\n            this.seek(this.leftVideo.currentTime());\n        } else {\n            this.pause()\n                .then(() => this.play())\n        }\n    }\n\n    playPause() {\n        if(this.state.playing) {\n            this.pause();\n        } else {\n            this.play();\n        }\n    }\n\n    async step(steps) {\n        const newTime = this.rightVideo.currentTime() + 0.04 * steps;\n        this.rightVideo.quickSeek(newTime);\n        this.leftVideo.quickSeek(newTime);\n    }\n\n    fullscreen() {\n        if(isFullscreen()) {\n            closeFullscreen();\n        } else {\n            openFullscreen(this.videoViewer);\n        }\n    }\n\n    onTimeUpdate(time) {\n        this.setPosition(time);\n    }\n\n    onDurationSet(duration) {\n        this.setState({duration})\n    }\n\n    syncPlayers() {\n        this.leftVideo.seek(this.rightVideo.currentTime());\n        this.setPosition(this.leftVideo.currentTime());\n    }\n\n    async playForward() {\n        if (this.state.playing) {\n            await this.pause();\n        }\n        this.leftVideo.playbackRate = 1;\n        this.rightVideo.playbackRate = 1;\n        return this.play();\n    }\n\n    async play() {\n        if(this.state.playing) {\n            return Promise.resolve();\n        }\n        await Promise.all([this.rightVideo.play(), this.leftVideo.play()])\n        this.setPlaying(true);\n\n    }\n\n    async pause() {\n        if (!this.state.playing) {\n            return Promise.resolve();\n        }\n        this.rightVideo.pause();\n        this.leftVideo.pause();\n        this.setPlaying(false);\n        return this.seek(this.leftVideo.currentTime());\n    }\n\n    async seek(pos) {\n        this.setState({position: pos});\n        return Promise.all([this.leftVideo.seek(pos), this.rightVideo.seek(pos + this.state.rightVideoOffset * 0.04)]);\n    }\n\n    async onLeftSourceChange(source) {\n        await this.changeSource(this.leftVideo, source);\n        this.setLeftSource(source);\n        this.splitView.focus();\n    }\n\n\n    async onRightSourceChange(source) {\n        await this.changeSource(this.rightVideo, source);\n        this.setRightSource(source);\n        this.splitView.focus();\n    }\n\n    async changeSource(videoElement, source) {\n        const wasPlaying = this.state.playing;\n        const wasPlayingReverse = this.state.playReverse;\n        await this.pause();\n        const time = videoElement.currentTime();\n        console.log(`${JSON.stringify(videoElement.props)} time: ${time}`);\n        await videoElement.loadSource(source.url);\n        await this.seek(time);\n        if (wasPlaying) {\n            await this.play();\n        }\n        if (wasPlayingReverse) {\n            await this.playReverse();\n        }\n    }\n\n    zoomIn() {\n        this.leftVideo.zoomIn();\n        this.rightVideo.zoomIn();\n        this.setState({userDefinedPanZoom: true});\n    }\n\n    zoomOut() {\n        this.leftVideo.zoomOut();\n        this.rightVideo.zoomOut();\n        this.setState({userDefinedPanZoom: true});\n    }\n\n    resetPanZoom() {\n        this.leftVideo.resetPanZoom();\n        this.rightVideo.resetPanZoom();\n        this.setState({userDefinedPanZoom: false});\n    }\n\n    pan(deltaX, deltaY) {\n        this.leftVideo.pan(deltaX, deltaY);\n        this.rightVideo.pan(deltaX, deltaY);\n        this.setState({userDefinedPanZoom: true});\n    }\n\n\n    shortCutHandlers = [\n        [COMMANDS.STEP_FORWARD, () => this.step(25)],\n        [COMMANDS.STEP_FORWARD_FRAME, () => this.step(1)],\n        [COMMANDS.STEP_BACKWARD_FRAME, () => this.step(-1)],\n        [COMMANDS.STEP_BACKWARD, () => this.step(-25)],\n        [COMMANDS.PLAY_PAUSE, () => this.playPause()],\n        [COMMANDS.FULLSCREEN, () => this.fullscreen()],\n        [COMMANDS.TOGGLE_TRACKING, () => this.toggleTracking()],\n        [COMMANDS.LEFT_ONLY, () => this.splitView.setSplitPosition(100)],\n        [COMMANDS.RIGHT_ONLY, () => this.splitView.setSplitPosition(0)],\n        [COMMANDS.TIMESHIFT_INCREASE, () => this.changeOffset(1)],\n        [COMMANDS.TIMESHIFT_DECREASE, () => this.changeOffset(-1)],\n        [COMMANDS.TIMESHIFT_RESET, () => this.changeOffset(0)],\n        [COMMANDS.ZOOM_IN, () => this.zoomIn()],\n        [COMMANDS.ZOOM_OUT, () => this.zoomOut()],\n        [COMMANDS.PAN_UP, () => this.pan(0, 10)],\n        [COMMANDS.PAN_DOWN, () => this.pan(0, -10)],\n        [COMMANDS.PAN_RIGHT, () => this.pan(-10, 0)],\n        [COMMANDS.PAN_LEFT, () => this.pan(10, 0)],\n        [COMMANDS.REST_PAN_ZOOM, () => this.resetPanZoom()],\n        [COMMANDS.PLAY, () => this.playForward()],\n        [COMMANDS.PAUSE, () => this.pause()],\n        [COMMANDS.TOGGLE_HELP, () => this.toggleShowHelp()],\n        [COMMANDS.TOGGLE_SPLIT_BORDER_VISIBLE, () => this.toggleSplitBorderVisible()]\n    ].reduce((result, [command, action]) => Object.assign(result, {[command.name]: action}), {});\n\n    toggleShowHelp() {\n        this.setState({showHelp: !this.state.showHelp});\n    }\n\n    toggleSplitBorderVisible() {\n        this.setState({splitBorderVisible: !this.state.splitBorderVisible});\n    }\n\n    onFullScreenChange() {\n        if (!this.state.userDefinedPanZoom) {\n            this.resetPanZoom();\n        }\n    }\n\n    componentDidMount() {\n        this.splitView.focus();\n        this.seek(startPosition)\n            .catch(e => console.trace(e));\n        this.videoViewer.addEventListener('fullscreenchange', this.onFullScreenChange);\n    }\n\n    componentWillUnmount(){\n        this.videoViewer.removeEventListener('fullscreenchange', this.onFullScreenChange);\n    }\n\n    render() {\n\n        return (\n            <div className=\"video-viewer\"\n                 tabIndex=\"0\"\n                 ref={this.setVideoViewerRef}>\n                <TimeDisplay position={this.state.position}/>\n                <HotKeys className=\"hotkeys-div\" keyMap={KEY_MAP} handlers={this.shortCutHandlers}>\n                    <SplitView tracking={this.state.tracking}\n                               splitBorderVisible={this.state.splitBorderVisible}\n                               onDrag={(dx,dy) => this.pan(dx,dy)}\n                               onClick={() => this.playPause()}\n                               ref={this.setSplitViewRef}\n                               leftSideContent={(<VideoPlayer muted ref={this.setLeftVideoRef} />)}\n                    >\n\n                        <VideoPlayer ref={this.setRightVideoRef}\n                                     onTimeUpdate={(time) => this.onTimeUpdate(time)}\n                                     onDurationSet={(duration) => this.onDurationSet(duration)}\n                        />\n                        <div className={cx(\"big-play-button\", {\n                            \"hidden\": this.state.playing || this.state.position !== 0\n                        })}\n                             onClick={() => this.play()}\n                        >\n                            <FiPlay size=\"32px\"/>\n                        </div>\n                    </SplitView>\n                    \n                    <VideoControls playing={this.state.playing}\n                                   onPlay={() => this.playPause()}\n                                   onStep={(n) => this.step(n)}\n                                   onFullscreen={() => this.fullscreen()}\n                                   duration={this.state.duration}\n                                   onSeek={(pos) => this.seek(pos)}\n                                   position={this.state.position}\n                    />\n\n                    <SourceSelector className=\"left-source-selector\"\n                                    defaultSource={DEFAULT_SOURCE_LEFT}\n                                    onChange={(value) => this.onLeftSourceChange(value)} />\n                    <SourceSelector className=\"right-source-selector\"\n                                    defaultSource={DEFAULT_SOURCE_RIGHT}\n                                    onChange={(value) => this.onRightSourceChange(value)} />\n                    <OffsetIndicator offset={this.state.rightVideoOffset}/>\n                    <Help visible={this.state.showHelp} onClick={() => this.toggleShowHelp()} />\n                    <HelpButton onClick={() => this.toggleShowHelp()} />\n                </HotKeys>\n            </div>\n\n        );\n    }\n}\n\nexport default VideoViewer;","export function openFullscreen(elem) {\n    if (elem.requestFullscreen) {\n        elem.requestFullscreen();\n    } else if (elem.mozRequestFullScreen) { /* Firefox */\n        elem.mozRequestFullScreen();\n    } else if (elem.webkitRequestFullscreen) { /* Chrome, Safari and Opera */\n        elem.webkitRequestFullscreen();\n    } else if (elem.msRequestFullscreen) { /* IE/Edge */\n        elem.msRequestFullscreen();\n    }\n}\n\nexport function isFullscreen() {\n    return document.fullScreen || document.mozFullScreen || document.webkitIsFullScreen;\n}\n\nexport function closeFullscreen() {\n    if (document.exitFullscreen) {\n        document.exitFullscreen();\n    } else if (document.mozCancelFullScreen) { /* Firefox */\n        document.mozCancelFullScreen();\n    } else if (document.webkitExitFullscreen) { /* Chrome, Safari and Opera */\n        document.webkitExitFullscreen();\n    } else if (document.msExitFullscreen) { /* IE/Edge */\n        document.msExitFullscreen();\n    }\n}\n","import React, { Component } from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './App.css';\n\nimport VideoViewer from './components/VideoViewer';\n\nclass App extends Component {\n  render() {\n    return (\n      <div className=\"App\">\n        <VideoViewer />\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}